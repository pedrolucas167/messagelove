<!DOCTYPE html>
<html lang="pt-BR" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messagelove - Crie Cartões Especiais Personalizados</title>
    <meta name="description" content="Crie cartões especiais com mensagens personalizadas, fotos e vídeos do YouTube para presentear quem você ama.">
    <meta name="theme-color" content="#e91e63">

    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline';
        frame-src 'self' https://www.youtube.com;
        img-src 'self' data: https:;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        connect-src 'self' https://messagelove-backend.onrender.com http://localhost:3001 https://www.youtube.com;
    ">

    <meta property="og:title" content="Messagelove - Crie Cartões Especiais">
    <meta property="og:description" content="Crie cartões especiais com mensagens personalizadas, fotos e vídeos do YouTube para presentear quem você ama.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://messagelove-frontend.vercel.app">
    <meta property="og:image" content="/assets/og-image.jpg">
    <meta property="og:image:alt" content="Cartão Messagelove">
    <meta property="og:locale" content="pt_BR">

    <link rel="icon" href="/coracao.png" type="image/png">
    <link rel="manifest" href="/manifest.webmanifest">

    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@500&family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/style.css" media="all">
</head>

<body class="font-body text-text bg-bg min-h-screen flex flex-col">
    <header class="py-8 bg-primary text-surface" role="banner">
        <div class="container mx-auto px-4">
            <h1 class="font-heading text-3xl sm:text-4xl text-center">Crie um Cartão Especial</h1>
            <p class="text-center text-lg mt-2 opacity-90">Compartilhe seu amor com mensagens personalizadas, fotos e vídeos.</p>
        </div>
    </header>

    <main class="flex-grow py-8" role="main">
        <div class="container mx-auto px-4">
            <form id="cardForm" class="bg-surface p-6 sm:p-8 rounded-lg shadow-md max-w-2xl mx-auto" novalidate role="form" aria-labelledby="form-title">
                <fieldset class="mb-6">
                    <legend id="form-title" class="font-heading text-2xl text-primary-dark mb-4">
                        Informações do Cartão
                    </legend>

                    <div class="mb-4">
                        <label for="deInput" class="block text-sm font-semibold text-text after:content-['*'] after:text-error">Seu Nome (Remetente)</label>
                        <input type="text" id="deInput" name="de" class="w-full p-3 mt-1 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary" required placeholder="Quem está enviando?" aria-required="true">
                    </div>

                    <div class="mb-4">
                        <label for="nome" class="block text-sm font-semibold text-text after:content-['*'] after:text-error">Nome do Destinatário</label>
                        <input type="text" id="nome" name="para" class="w-full p-3 mt-1 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary" required placeholder="Para quem é este cartão?" aria-required="true">
                    </div>

                    <div class="mb-4">
                        <label for="data" class="block text-sm font-semibold text-text">Data Especial (Opcional)</label>
                        <input type="date" id="data" name="data" class="w-full p-3 mt-1 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary">
                    </div>

                    <div class="mb-4">
                        <label for="mensagem" class="block text-sm font-semibold text-text after:content-['*'] after:text-error">Sua Mensagem</label>
                        <textarea id="mensagem" name="mensagem" class="w-full p-3 mt-1 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary h-32 resize-y" required placeholder="Escreva sua mensagem especial..." aria-required="true"></textarea>
                    </div>
                </fieldset>

                <fieldset class="mb-6">
                    <legend class="font-heading text-xl text-primary-dark mb-4">
                        Adicionais (Opcional)
                    </legend>

                    <div class="mb-4">
                        <label for="fotoUpload" class="block text-sm font-semibold text-text">Adicionar Foto</label>
                        <input type="file" id="fotoUpload" name="foto" accept="image/jpeg,image/png,image/gif" class="w-full p-3 mt-1 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary file:bg-primary file:text-surface file:border-0 file:rounded-md file:px-4 file:py-2 file:mr-2" aria-describedby="foto-upload-desc">
                        <p id="foto-upload-desc" class="text-xs text-muted mt-1">Formatos aceitos: JPEG, PNG, GIF</p>
                        <div class="preview-container mt-4 hidden" data-js="preview-container">
                            <img class="preview max-h-64 w-auto rounded-md shadow-sm" alt="Pré-visualização da foto" data-js="foto-preview">
                            <button type="button" class="btn btn-remove absolute top-2 right-2 bg-error text-surface rounded-full w-8 h-8 flex items-center justify-center" data-js="remove-foto" aria-label="Remover foto">×</button>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="youtubeUrlInput" class="block text-sm font-semibold text-text">Link do YouTube</label>
                        <div class="flex gap-2">
                            <input type="url" id="youtubeUrlInput" class="w-full p-3 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Cole o link do vídeo aqui" aria-describedby="youtube-error">
                            <button type="button" id="addYoutubeUrlBtn" class="bg-primary text-surface font-semibold py-3 px-6 rounded-md hover:bg-primary-dark transition-all">Adicionar</button>
                        </div>
                        <div id="youtubeError" class="text-error text-sm mt-1" aria-live="polite"></div>
                    </div>

                    <div id="youtubePreviewContainer" class="hidden mt-4">
                        <div class="relative pb-[56.25%] rounded-md overflow-hidden shadow-md">
                            <iframe id="youtubePlayer" class="absolute inset-0 w-full h-full" allowfullscreen title="Pré-visualização do vídeo do YouTube"></iframe>
                        </div>
                    </div>

                    <input type="hidden" id="youtubeVideoIdInputHidden" name="youtubeVideoId">
                </fieldset>

                <div class="text-center">
                    <button type="submit" class="bg-primary text-surface font-semibold py-3 px-8 rounded-full hover:bg-primary-dark hover:-translate-y-1 transition-all focus:ring-2 focus:ring-primary" id="submitBtn">
                        <span class="btn-text">Criar Cartão</span>
                        <span class="btn-loading inline-flex items-center gap-2" aria-hidden="true" hidden>
                            <span class="btn-spinner w-4 h-4 border-2 border-surface border-t-transparent rounded-full animate-spin"></span> Processando...
                        </span>
                    </button>
                </div>
            </form>

            <div id="successModal" class="fixed inset-0 bg-black/70 grid place-items-center hidden" role="dialog" aria-labelledby="modal-title">
                <div class="bg-surface p-6 rounded-lg shadow-lg max-w-md w-full text-center relative">
                    <button id="closeModalBtn" class="absolute top-2 right-2 text-text hover:text-error text-xl" type="button" aria-label="Fechar modal">×</button>
                    <h2 id="modal-title" class="font-heading text-2xl text-primary-dark mb-4">Cartão Criado! ✨</h2>
                    <p class="text-text mb-4">Compartilhe este link com aquela pessoa especial:</p>
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="generatedCardLink" readonly class="flex-1 p-3 border border-border rounded-md bg-light text-text" aria-label="Link do cartão gerado">
                        <button type="button" id="copyLinkBtn" class="bg-primary text-surface py-2 px-4 rounded-md hover:bg-primary-dark transition-all">Copiar</button>
                    </div>
                    <div class="flex gap-4 justify-center flex-wrap">
                        <a href="#" id="viewCardBtn" class="bg-primary text-surface py-3 px-6 rounded-md hover:bg-primary-dark transition-all" target="_blank" rel="noopener noreferrer">Ver Cartão</a>
                        <button type="button" id="createAnotherBtn" class="bg-transparent border-2 border-primary text-primary py-2 px-4 rounded-md hover:bg-primary hover:text-surface transition-all">Criar Outro Cartão</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="py-6 bg-primary-dark text-surface text-center" role="contentinfo">
        <div class="container mx-auto px-4">
            <p>
                <span>Messagelove © <span id="currentYear"></span></span>
                <span>Feito com <span aria-label="coração">❤️</span> por <a href="https://pedrolucas167.github.io/portfolio/" target="_blank" rel="noopener noreferrer" class="underline hover:text-secondary">Pedro Marques</a></span>
            </p>
        </div>
    </footer>

    <div id="appNotificationArea" class="fixed bottom-4 right-4 space-y-2" aria-live="polite"></div>

    <canvas id="particle-canvas" class="hidden" aria-hidden="true"></canvas>

    <script src="/script.js" defer></script>
</body>
</html>